<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Jornal Reino dos C√©us</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
    <style>
        /* Estilos cr√≠ticos para garantir que os cards apare√ßam */
        .jornal-card {
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
            background: #ffffff !important;
            border-radius: 16px !important;
        }
        .jornais-grid {
            display: grid !important;
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr)) !important;
            gap: 28px !important;
        }
        
        /* Layout Profissional de Login */
        .login-wrapper {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .login-wrapper::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: moveBackground 20s linear infinite;
        }
        
        @keyframes moveBackground {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }
        
        .login-container {
            position: relative;
            z-index: 1;
            max-width: 440px;
            width: 100%;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            padding: 48px 40px;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: fadeInUp 0.6s ease-out;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .login-logo {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            margin-bottom: 24px;
            color: white;
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.4);
        }
        
        .login-title {
            font-size: 32px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }
        
        .login-subtitle {
            font-size: 15px;
            color: #64748b;
            line-height: 1.5;
        }
        
        .login-form {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .form-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 600;
            color: #334155;
        }
        
        .form-label svg {
            color: #64748b;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            font-size: 15px;
            color: #1e293b;
            background: #ffffff;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            transition: all 0.2s ease;
            outline: none;
            pointer-events: auto !important;
            user-select: text !important;
        }
        
        .form-input::placeholder {
            color: #94a3b8;
        }
        
        .form-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
            background: #ffffff;
        }
        
        .form-input:hover {
            border-color: #cbd5e1;
        }
        
        .btn-login {
            width: 100%;
            padding: 16px;
            font-size: 16px;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
            margin-top: 8px;
        }
        
        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.5);
        }
        
        .btn-login:active {
            transform: translateY(0);
        }
        
        .btn-login svg {
            transition: transform 0.3s ease;
        }
        
        .btn-login:hover svg {
            transform: translateX(4px);
        }
        
        .error-message {
            padding: 12px 16px;
            background: #fee2e2;
            color: #dc2626;
            border-radius: 8px;
            font-size: 14px;
            margin-top: -8px;
            display: none;
            border: 1px solid #fecaca;
        }
        
        .error-message.show {
            display: block;
            animation: shake 0.4s ease;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }
        
        /* Responsivo */
        @media (max-width: 480px) {
            .login-container {
                padding: 32px 24px;
                border-radius: 20px;
            }
            
            .login-title {
                font-size: 28px;
            }
            
            .login-logo {
                width: 56px;
                height: 56px;
            }
        }
        
        /* Garantir que o overlay de loading n√£o bloqueie o login */
        .loading-overlay {
            pointer-events: none !important;
        }
        
        .loading-overlay.hidden {
            display: none !important;
        }
    </style>
    <script>
        // Suprimir erros de arquivos que n√£o pertencem ao dashboard
        const originalError = console.error;
        console.error = function(...args) {
            const message = args.join(' ');
            if (
                message.includes('gsap.min.js') ||
                message.includes('style_efeitos.js') ||
                message.includes('materia-jornal') ||
                message.includes('MIME type') ||
                message.includes('Refused to execute script')
            ) {
                // Ignorar esses erros
                return;
            }
            originalError.apply(console, args);
        };
        
        // Carregar CSS com timestamp para evitar cache
        const cssLink = document.createElement('link');
        cssLink.rel = 'stylesheet';
        cssLink.href = `/dashboard/css/style.css?v=4.0&t=${Date.now()}`;
        document.head.appendChild(cssLink);
        
        // Log para verificar se os estilos est√£o carregando
        cssLink.onload = () => console.log('‚úÖ CSS carregado com sucesso!');
        cssLink.onerror = () => console.error('‚ùå Erro ao carregar CSS!');
        
        // Garantir que os campos de login estejam sempre habilitados
        document.addEventListener('DOMContentLoaded', function() {
            const emailInput = document.getElementById('email');
            const passwordInput = document.getElementById('password');
            
            if (emailInput) {
                emailInput.removeAttribute('readonly');
                emailInput.removeAttribute('disabled');
                emailInput.style.pointerEvents = 'auto';
                emailInput.style.userSelect = 'text';
                emailInput.style.webkitUserSelect = 'text';
            }
            
            if (passwordInput) {
                passwordInput.removeAttribute('readonly');
                passwordInput.removeAttribute('disabled');
                passwordInput.style.pointerEvents = 'auto';
                passwordInput.style.userSelect = 'text';
                passwordInput.style.webkitUserSelect = 'text';
            }
            
            // Remover qualquer overlay de loading que possa estar bloqueando
            const loadingOverlays = document.querySelectorAll('.loading-overlay');
            loadingOverlays.forEach(overlay => {
                overlay.classList.add('hidden');
                overlay.style.display = 'none';
                overlay.style.pointerEvents = 'none';
            });
        });
    </script>
</head>
<body>
    <div id="app">
        <!-- Tela de Login -->
        <div id="loginScreen" class="screen">
            <div class="login-wrapper">
                <div class="login-container">
                    <div class="login-header">
                        <div class="login-logo">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 2L2 7L12 12L22 7L12 2Z" fill="currentColor"/>
                                <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                        <h1 class="login-title">Bem-vindo</h1>
                        <p class="login-subtitle">Entre com suas credenciais para acessar o dashboard</p>
                    </div>
                    <form id="loginForm" class="login-form" onsubmit="event.preventDefault(); return false;">
                        <div class="form-group">
                            <label for="email" class="form-label">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M4 4H20C21.1 4 22 4.9 22 6V18C22 19.1 21.1 20 20 20H4C2.9 20 2 19.1 2 18V6C2 4.9 2.9 4 4 4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M22 6L12 13L2 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Email
                            </label>
                            <input 
                                type="email" 
                                id="email" 
                                name="email" 
                                class="form-input" 
                                autocomplete="email" 
                                placeholder="seu@email.com"
                                required
                            >
                        </div>
                        <div class="form-group">
                            <label for="password" class="form-label">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                                    <path d="M7 11V7C7 4.23858 9.23858 2 12 2C14.7614 2 17 4.23858 17 7V11" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                Senha
                            </label>
                            <input 
                                type="password" 
                                id="password" 
                                name="password" 
                                class="form-input" 
                                autocomplete="current-password" 
                                placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                required
                            >
                        </div>
                        <button 
                            type="button" 
                            id="loginSubmitBtn" 
                            class="btn-login" 
                            onclick="(function() { if(typeof window.handleLogin === 'function') { window.handleLogin(event); } else if(typeof handleLogin === 'function') { window.handleLogin = handleLogin; window.handleLogin(event); } else { console.error('handleLogin n√£o est√° dispon√≠vel! Tentando novamente em 200ms...'); setTimeout(function() { if(typeof window.handleLogin === 'function') { window.handleLogin(event); } else if(typeof handleLogin === 'function') { window.handleLogin = handleLogin; window.handleLogin(event); } else { alert('Erro: Fun√ß√£o de login n√£o carregada. Por favor, recarregue a p√°gina (Ctrl+F5).'); } }, 200); } })();"
                        >
                            <span>Entrar</span>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        <div id="loginError" class="error-message"></div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Dashboard Principal -->
        <div id="dashboardScreen" class="screen hidden">
            <header class="dashboard-header">
                <h1>Dashboard - Gerenciamento de Jornais</h1>
                <div class="header-actions">
                    <span id="userName"></span>
                    <button id="logoutBtn" class="btn btn-secondary">Sair</button>
                </div>
            </header>

            <main class="dashboard-main">
                <div class="dashboard-tabs">
                    <button class="tab-btn active" data-tab="jornais">Jornais</button>
                    <button class="tab-btn" data-tab="carrossel">Carrossel</button>
                    <button class="tab-btn" data-tab="carrossel-medio">Carrossel M√©dio</button>
                    <button class="tab-btn" data-tab="video">V√≠deo</button>
                    <button class="tab-btn" data-tab="responsaveis">Respons√°veis</button>
                    <button class="tab-btn" data-tab="faq">FAQ</button>
                    <button class="tab-btn" data-tab="sites">Sites Igreja</button>
                    <button class="tab-btn" data-tab="textos">Textos</button>
                    <button class="tab-btn" data-tab="banner">Banner Modal</button>
                    <button class="tab-btn" data-tab="noticias">Not√≠cias</button>
                    <button class="tab-btn" data-tab="colunistas">Colunistas</button>
                    <button class="tab-btn" data-tab="pagamentos">Pagamentos</button>
                </div>

                <!-- Tab Jornais -->
                <div class="tab-content active" id="tab-jornais">
                    <div class="dashboard-actions">
                        <button id="newJornalBtn" class="btn btn-primary" onclick="if(typeof openJornalModal === 'function') { openJornalModal(); } else { console.error('openJornalModal n√£o est√° dispon√≠vel!'); alert('Erro: Fun√ß√£o n√£o dispon√≠vel. Recarregue a p√°gina.'); }">+ Novo Jornal</button>
                    </div>
                    <div id="jornaisList" class="jornais-grid"></div>
                </div>

                <!-- Tab Carrossel -->
                <div class="tab-content" id="tab-carrossel">
                    <div class="dashboard-actions">
                        <button id="newCarrosselBtn" class="btn btn-primary" onclick="if(typeof window.openCarrosselModal === 'function') { window.openCarrosselModal(); } else { console.error('openCarrosselModal n√£o est√° dispon√≠vel!'); alert('Erro: Fun√ß√£o n√£o dispon√≠vel. Recarregue a p√°gina.'); }">+ Novo Item</button>
                    </div>
                    <div id="carrosselList" class="jornais-grid"></div>
                </div>

                <!-- Tab Carrossel M√©dio -->
                <div class="tab-content" id="tab-carrossel-medio">
                    <div class="dashboard-actions">
                        <button id="newCarrosselMedioBtn" class="btn btn-primary" onclick="if(typeof window.openCarrosselMedioModal === 'function') { window.openCarrosselMedioModal(); } else { console.error('openCarrosselMedioModal n√£o est√° dispon√≠vel!'); alert('Erro: Fun√ß√£o n√£o dispon√≠vel. Recarregue a p√°gina.'); }">+ Novo Item</button>
                    </div>
                    <div id="carrosselMedioList" class="jornais-grid"></div>
                </div>

                <!-- Tab V√≠deo -->
                <div class="tab-content" id="tab-video">
                    <div id="videoConfig" class="config-section"></div>
                </div>

                <!-- Tab Respons√°veis -->
                <div class="tab-content" id="tab-responsaveis">
                    <div class="dashboard-actions">
                        <button id="newResponsavelBtn" class="btn btn-primary" onclick="if(typeof window.openResponsavelModal === 'function') { window.openResponsavelModal(); } else { console.error('openResponsavelModal n√£o est√° dispon√≠vel!'); alert('Erro: Fun√ß√£o n√£o dispon√≠vel. Recarregue a p√°gina.'); }">+ Novo Respons√°vel</button>
                    </div>
                    <div id="responsaveisList" class="jornais-grid"></div>
                </div>

                <!-- Tab FAQ -->
                <div class="tab-content" id="tab-faq">
                    <div class="dashboard-actions">
                        <button id="newFaqBtn" class="btn btn-primary" onclick="if(typeof window.openFaqModal === 'function') { window.openFaqModal(); } else { console.error('openFaqModal n√£o est√° dispon√≠vel!'); alert('Erro: Fun√ß√£o n√£o dispon√≠vel. Recarregue a p√°gina.'); }">+ Nova Pergunta</button>
                    </div>
                    <div id="faqList"></div>
                </div>

                <!-- Tab Sites -->
                <div class="tab-content" id="tab-sites">
                    <div class="dashboard-actions">
                        <button id="newSiteBtn" class="btn btn-primary" onclick="if(typeof window.openSiteModal === 'function') { window.openSiteModal(); } else { console.error('openSiteModal n√£o est√° dispon√≠vel!'); alert('Erro: Fun√ß√£o n√£o dispon√≠vel. Recarregue a p√°gina.'); }">+ Novo Site</button>
                    </div>
                    <div id="sitesList" class="jornais-grid"></div>
                </div>

                <!-- Tab Textos -->
                <div class="tab-content" id="tab-textos">
                    <div id="textosConfig" class="config-section"></div>
                </div>

                <!-- Tab Banner -->
                <div class="tab-content" id="tab-banner">
                    <div id="bannerConfig" class="config-section"></div>
                </div>

                <!-- Tab Not√≠cias -->
                <div class="tab-content" id="tab-noticias">
                    <div class="dashboard-actions">
                        <button id="newNoticiaBtn" class="btn btn-primary" onclick="if(typeof window.openNoticiaModal === 'function') { window.openNoticiaModal(); } else { console.error('openNoticiaModal n√£o est√° dispon√≠vel!'); alert('Erro: Fun√ß√£o n√£o dispon√≠vel. Recarregue a p√°gina.'); }">+ Nova Not√≠cia</button>
                    </div>
                    <div id="noticiasList"></div>
                </div>

                <!-- Tab Colunistas -->
                <div class="tab-content" id="tab-colunistas">
                    <div class="dashboard-actions">
                        <button id="newColunistaBtn" class="btn btn-primary" onclick="if(typeof window.openColunistaModal === 'function') { window.openColunistaModal(); } else { console.error('openColunistaModal n√£o est√° dispon√≠vel!'); alert('Erro: Fun√ß√£o n√£o dispon√≠vel. Recarregue a p√°gina.'); }">+ Novo Colunista</button>
                    </div>
                    <div id="colunistasList" class="jornais-grid"></div>
                </div>

                <!-- Tab Pagamentos -->
                <div class="tab-content" id="tab-pagamentos">
                    <div class="dashboard-actions">
                        <button id="updatePaymentValuesBtn" class="btn btn-secondary" onclick="if(typeof window.updatePaymentValues === 'function') { window.updatePaymentValues(); } else { console.error('updatePaymentValues n√£o est√° dispon√≠vel!'); alert('Erro: Fun√ß√£o n√£o dispon√≠vel. Recarregue a p√°gina.'); }">üîÑ Atualizar Valores dos Pagamentos</button>
                    </div>
                    <div id="pagamentosList"></div>
                </div>
            </main>
        </div>
    </div>

    <!-- Modal para Criar/Editar Jornal -->
    <div id="jornalModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Novo Jornal</h2>
                <button type="button" class="modal-close" id="closeModal" onclick="if(typeof closeModal === 'function') { closeModal(); } else if(typeof window.closeModal === 'function') { window.closeModal(); } else { console.error('closeModal n√£o est√° dispon√≠vel!'); const modal = document.getElementById('jornalModal'); if(modal) { modal.classList.add('hidden'); modal.style.display = 'none'; } }">&times;</button>
            </div>
            <form id="jornalForm" onsubmit="event.preventDefault(); if(typeof handleSaveJornal === 'function') { handleSaveJornal(event); } else if(typeof window.handleSaveJornal === 'function') { window.handleSaveJornal(event); } else { console.error('handleSaveJornal n√£o est√° dispon√≠vel!'); } return false;">
                <input type="hidden" id="jornalId">
                
                <div class="form-group">
                    <label for="nome">Nome do Jornal *</label>
                    <input type="text" id="nome" name="nome" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="mes">M√™s *</label>
                        <input type="text" id="mes" name="mes" required>
                    </div>
                    <div class="form-group">
                        <label for="ano">Ano *</label>
                        <input type="number" id="ano" name="ano" required min="2020" max="2100">
                    </div>
                    <div class="form-group">
                        <label for="ordem">Ordem</label>
                        <input type="number" id="ordem" name="ordem" min="1">
                    </div>
                </div>

                <div class="form-group">
                    <label for="descricao">Descri√ß√£o</label>
                    <textarea id="descricao" name="descricao" rows="4"></textarea>
                </div>

                <div class="form-group">
                    <label for="linkCompra">Link de Compra</label>
                    <input type="url" id="linkCompra" name="linkCompra">
                </div>

                <div class="form-group">
                    <label for="ativo">Status</label>
                    <select id="ativo" name="ativo">
                        <option value="true">Ativo</option>
                        <option value="false">Inativo</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="capa">Capa (Imagem)</label>
                    <input type="file" id="capa" name="capa" accept="image/*">
                    <div id="capaPreview" class="image-preview"></div>
                </div>

                <div class="form-group">
                    <label for="pdf">PDF para Download *</label>
                    <input type="file" id="pdf" name="pdf" accept="application/pdf">
                    <small class="form-help">Arquivo PDF que ser√° baixado ap√≥s a compra. Obrigat√≥rio para novos jornais.</small>
                    <div id="pdfPreview" class="pdf-preview"></div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelBtn" onclick="if(typeof closeModal === 'function') { closeModal(); } else if(typeof window.closeModal === 'function') { window.closeModal(); } else { console.error('closeModal n√£o est√° dispon√≠vel!'); const modal = document.getElementById('jornalModal'); if(modal) { modal.classList.add('hidden'); modal.style.display = 'none'; } }">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Criar/Editar Carrossel -->
    <div id="carrosselModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="carrosselModalTitle">Novo Item</h2>
                <button type="button" class="modal-close" id="closeCarrosselModal" onclick="if(typeof window.closeCarrosselModal === 'function') { window.closeCarrosselModal(); } else { console.error('closeCarrosselModal n√£o est√° dispon√≠vel!'); const modal = document.getElementById('carrosselModal'); if(modal) { modal.classList.add('hidden'); modal.style.display = 'none'; } }">&times;</button>
            </div>
            <form id="carrosselForm" onsubmit="event.preventDefault(); if(typeof handleSaveCarrossel === 'function') { handleSaveCarrossel(event); } else if(typeof window.handleSaveCarrossel === 'function') { window.handleSaveCarrossel(event); } else { console.error('handleSaveCarrossel n√£o est√° dispon√≠vel!'); } return false;">
                <input type="hidden" id="carrosselId">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="carrosselOrdem">Ordem</label>
                        <input type="number" id="carrosselOrdem" name="ordem" min="1">
                    </div>
                    <div class="form-group">
                        <label for="carrosselAtivo">Status</label>
                        <select id="carrosselAtivo" name="ativo">
                            <option value="true">Ativo</option>
                            <option value="false">Inativo</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="carrosselImagem">Imagem *</label>
                    <input type="file" id="carrosselImagem" name="imagem" accept="image/*">
                    <small class="form-help">A imagem ser√° exibida no carrossel</small>
                    <div id="carrosselImagemPreview" class="image-preview"></div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelCarrosselBtn" onclick="if(typeof window.closeCarrosselModal === 'function') { window.closeCarrosselModal(); } else { console.error('closeCarrosselModal n√£o est√° dispon√≠vel!'); const modal = document.getElementById('carrosselModal'); if(modal) { modal.classList.add('hidden'); modal.style.display = 'none'; } }">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Criar/Editar Carrossel M√©dio -->
    <div id="carrosselMedioModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="carrosselMedioModalTitle">Novo Item</h2>
                <button type="button" class="modal-close" id="closeCarrosselMedioModal" onclick="if(typeof window.closeCarrosselMedioModal === 'function') { window.closeCarrosselMedioModal(); } else { console.error('closeCarrosselMedioModal n√£o est√° dispon√≠vel!'); const modal = document.getElementById('carrosselMedioModal'); if(modal) { modal.classList.add('hidden'); modal.style.display = 'none'; } }">&times;</button>
            </div>
            <form id="carrosselMedioForm" onsubmit="event.preventDefault(); if(typeof handleSaveCarrosselMedio === 'function') { handleSaveCarrosselMedio(event); } else if(typeof window.handleSaveCarrosselMedio === 'function') { window.handleSaveCarrosselMedio(event); } else { console.error('handleSaveCarrosselMedio n√£o est√° dispon√≠vel!'); } return false;">
                <input type="hidden" id="carrosselMedioId">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="carrosselMedioOrdem">Ordem</label>
                        <input type="number" id="carrosselMedioOrdem" name="ordem" min="1">
                    </div>
                    <div class="form-group">
                        <label for="carrosselMedioAtivo">Status</label>
                        <select id="carrosselMedioAtivo" name="ativo">
                            <option value="true">Ativo</option>
                            <option value="false">Inativo</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="carrosselMedioImagem">Imagem *</label>
                    <input type="file" id="carrosselMedioImagem" name="materia" accept="image/*">
                    <small class="form-help">A imagem ser√° exibida no carrossel m√©dio (recomendado: 800x600px)</small>
                    <div id="carrosselMedioImagemPreview" class="image-preview"></div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelCarrosselMedioBtn" onclick="if(typeof window.closeCarrosselMedioModal === 'function') { window.closeCarrosselMedioModal(); } else { console.error('closeCarrosselMedioModal n√£o est√° dispon√≠vel!'); const modal = document.getElementById('carrosselMedioModal'); if(modal) { modal.classList.add('hidden'); modal.style.display = 'none'; } }">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Criar/Editar Respons√°vel -->
    <div id="responsavelModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="responsavelModalTitle">Novo Respons√°vel</h2>
                <button type="button" class="modal-close" id="closeResponsavelModal" onclick="if(typeof window.closeResponsavelModal === 'function') { window.closeResponsavelModal(); } else { console.error('closeResponsavelModal n√£o est√° dispon√≠vel!'); const modal = document.getElementById('responsavelModal'); if(modal) { modal.classList.add('hidden'); modal.style.display = 'none'; } }">&times;</button>
            </div>
            <form id="responsavelForm" onsubmit="event.preventDefault(); if(typeof handleSaveResponsavel === 'function') { handleSaveResponsavel(event); } else if(typeof window.handleSaveResponsavel === 'function') { window.handleSaveResponsavel(event); } else { console.error('handleSaveResponsavel n√£o est√° dispon√≠vel!'); } return false;">
                <input type="hidden" id="responsavelId">
                
                <div class="form-group">
                    <label for="responsavelNome">Nome *</label>
                    <input type="text" id="responsavelNome" name="nome" required>
                </div>

                <div class="form-group">
                    <label for="responsavelCargo">Cargo *</label>
                    <input type="text" id="responsavelCargo" name="cargo" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="responsavelOrdem">Ordem</label>
                        <input type="number" id="responsavelOrdem" name="ordem" min="1">
                    </div>
                    <div class="form-group">
                        <label for="responsavelAtivo">Status</label>
                        <select id="responsavelAtivo" name="ativo">
                            <option value="true">Ativo</option>
                            <option value="false">Inativo</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="responsavelImagem">Foto</label>
                    <input type="file" id="responsavelImagem" name="imagem" accept="image/*">
                    <small class="form-help">A foto ser√° exibida no perfil do respons√°vel</small>
                    <div id="responsavelImagemPreview" class="image-preview"></div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelResponsavelBtn" onclick="if(typeof window.closeResponsavelModal === 'function') { window.closeResponsavelModal(); } else { console.error('closeResponsavelModal n√£o est√° dispon√≠vel!'); const modal = document.getElementById('responsavelModal'); if(modal) { modal.classList.add('hidden'); modal.style.display = 'none'; } }">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Criar/Editar FAQ -->
    <div id="faqModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="faqModalTitle">Nova Pergunta</h2>
                <button type="button" class="modal-close" id="closeFaqModal" onclick="if(typeof window.closeFaqModal === 'function') { window.closeFaqModal(); } else { console.error('closeFaqModal n√£o est√° dispon√≠vel!'); const modal = document.getElementById('faqModal'); if(modal) { modal.classList.add('hidden'); modal.style.display = 'none'; } }">&times;</button>
            </div>
            <form id="faqForm" onsubmit="event.preventDefault(); if(typeof handleSaveFAQ === 'function') { handleSaveFAQ(event); } else if(typeof window.handleSaveFAQ === 'function') { window.handleSaveFAQ(event); } else { console.error('handleSaveFAQ n√£o est√° dispon√≠vel!'); } return false;">
                <input type="hidden" id="faqId">
                
                <div class="form-group">
                    <label for="faqPergunta">Pergunta *</label>
                    <input type="text" id="faqPergunta" name="pergunta" required>
                </div>

                <div class="form-group">
                    <label for="faqResposta">Resposta *</label>
                    <textarea id="faqResposta" name="resposta" rows="6" required></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="faqOrdem">Ordem</label>
                        <input type="number" id="faqOrdem" name="ordem" min="1">
                    </div>
                    <div class="form-group">
                        <label for="faqAtivo">Status</label>
                        <select id="faqAtivo" name="ativo">
                            <option value="true">Ativo</option>
                            <option value="false">Inativo</option>
                        </select>
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelFaqBtn" onclick="if(typeof window.closeFaqModal === 'function') { window.closeFaqModal(); } else { console.error('closeFaqModal n√£o est√° dispon√≠vel!'); const modal = document.getElementById('faqModal'); if(modal) { modal.classList.add('hidden'); modal.style.display = 'none'; } }">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Criar/Editar Site -->
    <div id="siteModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="siteModalTitle">Novo Site</h2>
                <button type="button" class="modal-close" id="closeSiteModal" onclick="if(typeof window.closeSiteModal === 'function') { window.closeSiteModal(); } else { console.error('closeSiteModal n√£o est√° dispon√≠vel!'); const modal = document.getElementById('siteModal'); if(modal) { modal.classList.add('hidden'); modal.style.display = 'none'; } }">&times;</button>
            </div>
            <form id="siteForm">
                <input type="hidden" id="siteId">
                
                <div class="form-group">
                    <label for="siteNome">Nome *</label>
                    <input type="text" id="siteNome" name="nome" required>
                </div>

                <div class="form-group">
                    <label for="siteUrl">URL *</label>
                    <input type="url" id="siteUrl" name="url" required placeholder="https://example.com">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="siteOrdem">Ordem</label>
                        <input type="number" id="siteOrdem" name="ordem" min="1">
                    </div>
                    <div class="form-group">
                        <label for="siteAtivo">Status</label>
                        <select id="siteAtivo" name="ativo">
                            <option value="true">Ativo</option>
                            <option value="false">Inativo</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="siteImagem">Logo/Imagem</label>
                    <input type="file" id="siteImagem" name="imagem" accept="image/*">
                    <small class="form-help">A imagem/logo ser√° exibida para o site</small>
                    <div id="siteImagemPreview" class="image-preview"></div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelSiteBtn" onclick="if(typeof window.closeSiteModal === 'function') { window.closeSiteModal(); } else { console.error('closeSiteModal n√£o est√° dispon√≠vel!'); const modal = document.getElementById('siteModal'); if(modal) { modal.classList.add('hidden'); modal.style.display = 'none'; } }">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Criar/Editar Not√≠cia -->
    <div id="noticiaModal" class="modal hidden">
        <div class="modal-content" style="max-width: 800px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2 id="noticiaModalTitle">Nova Not√≠cia</h2>
                <button type="button" class="modal-close" id="closeNoticiaModal" onclick="if(typeof window.closeNoticiaModal === 'function') { window.closeNoticiaModal(); } else { console.error('closeNoticiaModal n√£o est√° dispon√≠vel!'); const modal = document.getElementById('noticiaModal'); if(modal) { modal.classList.add('hidden'); modal.style.display = 'none'; } }">&times;</button>
            </div>
            <form id="noticiaForm" onsubmit="event.preventDefault(); if(typeof handleSaveNoticia === 'function') { handleSaveNoticia(event); } else if(typeof window.handleSaveNoticia === 'function') { window.handleSaveNoticia(event); } else { console.error('handleSaveNoticia n√£o est√° dispon√≠vel!'); } return false;">
                <input type="hidden" id="noticiaId">
                
                <div class="form-group">
                    <label for="noticiaTitle">T√≠tulo *</label>
                    <input type="text" id="noticiaTitle" name="title" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="noticiaDate">Data</label>
                        <input type="date" id="noticiaDate" name="date">
                    </div>
                    <div class="form-group">
                        <label for="noticiaCategory">Categoria</label>
                        <select id="noticiaCategory" name="category">
                            <option value="Espiritualidade">Espiritualidade</option>
                            <option value="Maanaim">Maanaim</option>
                            <option value="Popular">Popular</option>
                            <option value="geral">Geral</option>
                            <option value="tecnologia">Tecnologia</option>
                            <option value="politica">Pol√≠tica</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="noticiaExcerpt">Resumo/Excerpt</label>
                    <textarea id="noticiaExcerpt" name="excerpt" rows="3" placeholder="Breve descri√ß√£o da not√≠cia que aparecer√° na lista"></textarea>
                </div>

                <div class="form-group">
                    <label for="noticiaContent">Conte√∫do *</label>
                    <textarea id="noticiaContent" name="content" rows="10" required placeholder="Conte√∫do completo da not√≠cia"></textarea>
                </div>

                <div class="form-group">
                    <label for="noticiaTag">Tag</label>
                    <input type="text" id="noticiaTag" name="tag" placeholder="Tags separadas por v√≠rgula">
                </div>

                <div class="form-group">
                    <label for="noticiaImage">Imagem</label>
                    <input type="file" id="noticiaImage" name="image" accept="image/*">
                    <small class="form-help">A imagem ser√° exibida na lista de not√≠cias</small>
                    <div id="noticiaImagePreview" class="image-preview"></div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelNoticiaBtn" onclick="if(typeof window.closeNoticiaModal === 'function') { window.closeNoticiaModal(); } else { console.error('closeNoticiaModal n√£o est√° dispon√≠vel!'); const modal = document.getElementById('noticiaModal'); if(modal) { modal.classList.add('hidden'); modal.style.display = 'none'; } }">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Criar/Editar Colunista -->
    <div id="colunistaModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="colunistaModalTitle">Novo Colunista</h2>
                <button type="button" class="modal-close" id="closeColunistaModal" onclick="if(typeof window.closeColunistaModal === 'function') { window.closeColunistaModal(); } else { console.error('closeColunistaModal n√£o est√° dispon√≠vel!'); const modal = document.getElementById('colunistaModal'); if(modal) { modal.classList.add('hidden'); modal.style.display = 'none'; } }">&times;</button>
            </div>
            <form id="colunistaForm" onsubmit="event.preventDefault(); if(typeof handleSaveColunista === 'function') { handleSaveColunista(event); } else if(typeof window.handleSaveColunista === 'function') { window.handleSaveColunista(event); } else { console.error('handleSaveColunista n√£o est√° dispon√≠vel!'); } return false;">
                <input type="hidden" id="colunistaId">
                
                <div class="form-group">
                    <label for="colunistaNome">Nome do Colunista *</label>
                    <input type="text" id="colunistaNome" name="nome" required placeholder="Ex: Bispo Rodrigo de Carvalho">
                </div>

                <div class="form-group">
                    <label for="colunistaColuna">Nome da Coluna *</label>
                    <input type="text" id="colunistaColuna" name="coluna" required placeholder="Ex: CULTURA DO REINO">
                    <small class="form-help">Nome que aparecer√° na caixa azul do card</small>
                </div>

                <div class="form-group">
                    <label for="colunistaConteudo">Conte√∫do da Mat√©ria *</label>
                    <textarea id="colunistaConteudo" name="conteudo" rows="10" required placeholder="Texto completo da mat√©ria do colunista"></textarea>
                    <small class="form-help">Texto que ser√° exibido no card do colunista</small>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="colunistaInstagram">Instagram</label>
                        <input type="text" id="colunistaInstagram" name="instagram" placeholder="Ex: @instagram_handle">
                    </div>
                    <div class="form-group">
                        <label for="colunistaOrdem">Ordem</label>
                        <input type="number" id="colunistaOrdem" name="ordem" min="1" value="0">
                        <small class="form-help">Ordem de exibi√ß√£o (menor n√∫mero aparece primeiro)</small>
                    </div>
                </div>

                <div class="form-group">
                    <label for="colunistaAtivo">Status</label>
                    <select id="colunistaAtivo" name="ativo">
                        <option value="true">Ativo</option>
                        <option value="false">Inativo</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="colunistaImagem">Imagem do Colunista</label>
                    <input type="file" id="colunistaImagem" name="imagem" accept="image/*">
                    <small class="form-help">Foto do colunista que ser√° exibida no card</small>
                    <div id="colunistaImagemPreview" class="image-preview"></div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelColunistaBtn" onclick="if(typeof window.closeColunistaModal === 'function') { window.closeColunistaModal(); } else { console.error('closeColunistaModal n√£o est√° dispon√≠vel!'); const modal = document.getElementById('colunistaModal'); if(modal) { modal.classList.add('hidden'); modal.style.display = 'none'; } }">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner"></div>
    </div>

    <script>
        // For√ßar recarregamento dos arquivos
        const timestamp = Date.now();
        console.log('üìù Carregando app.js...');
        
        const script = document.createElement('script');
        script.src = `/dashboard/js/app.js?v=31.0&t=${timestamp}`;
        script.type = 'text/javascript';
        script.async = false; // Carregar de forma s√≠ncrona para garantir ordem
        script.defer = false; // N√£o usar defer para garantir execu√ß√£o imediata
        
        script.onload = function() {
            console.log('‚úÖ app.js carregado com sucesso!');
            
            // Verificar IMEDIATAMENTE se handleLogin est√° dispon√≠vel
            function checkHandleLogin() {
                if (typeof window.handleLogin === 'function') {
                    console.log('‚úÖ window.handleLogin est√° dispon√≠vel!');
                    return true;
                } else if (typeof handleLogin === 'function') {
                    console.log('‚úÖ handleLogin est√° dispon√≠vel sem window - tornando global');
                    window.handleLogin = handleLogin;
                    return true;
                }
                return false;
            }
            
            // Verificar imediatamente
            if (!checkHandleLogin()) {
                // Se n√£o estiver dispon√≠vel, tentar novamente ap√≥s um pequeno delay
                let checkCount = 0;
                const maxChecks = 5;
                
                const retryCheck = () => {
                    checkCount++;
                    if (checkHandleLogin()) {
                        return;
                    } else if (checkCount < maxChecks) {
                        console.log('‚è≥ handleLogin ainda n√£o dispon√≠vel, tentando novamente em 200ms... (tentativa ' + checkCount + '/' + maxChecks + ')');
                        setTimeout(retryCheck, 200);
                    } else {
                        console.error('‚ùå handleLogin N√ÉO est√° dispon√≠vel ap√≥s ' + maxChecks + ' tentativas!');
                        console.error('Isso indica um erro no carregamento ou execu√ß√£o do app.js');
                        console.error('Verifique o console para erros de JavaScript');
                        // Criar um fallback b√°sico
                        window.handleLogin = function(e) {
                            alert('Erro: Fun√ß√£o de login n√£o foi carregada. Verifique o console do navegador (F12) para erros de JavaScript.');
                            console.error('handleLogin fallback - fun√ß√£o n√£o foi carregada corretamente');
                        };
                    }
                };
                
                setTimeout(retryCheck, 100);
            }
        };
        
        script.onerror = function() {
            console.error('‚ùå Erro ao carregar app.js!');
            alert('Erro ao carregar o JavaScript. Verifique se o servidor est√° rodando na porta 3000.');
        };
        
        document.head.appendChild(script);
        
        // Garantir que os campos de login estejam sempre habilitados (executar periodicamente)
        setInterval(function() {
            const emailInput = document.getElementById('email');
            const passwordInput = document.getElementById('password');
            
            if (emailInput) {
                emailInput.removeAttribute('readonly');
                emailInput.removeAttribute('disabled');
                emailInput.style.pointerEvents = 'auto';
                emailInput.style.userSelect = 'text';
            }
            
            if (passwordInput) {
                passwordInput.removeAttribute('readonly');
                passwordInput.removeAttribute('disabled');
                passwordInput.style.pointerEvents = 'auto';
                passwordInput.style.userSelect = 'text';
            }
            
            // Remover qualquer overlay que possa estar bloqueando
            const loadingOverlays = document.querySelectorAll('.loading-overlay:not(.hidden)');
            if (loadingOverlays.length > 0 && document.getElementById('loginScreen') && !document.getElementById('loginScreen').classList.contains('hidden')) {
                loadingOverlays.forEach(overlay => {
                    overlay.classList.add('hidden');
                    overlay.style.display = 'none';
                    overlay.style.pointerEvents = 'none';
                });
            }
        }, 500);
    </script>
</body>
</html>
